# ML Platform Environment Configuration
# Copy this file to .env and fill in your values

# ============================================================================
# Application
# ============================================================================
APP_NAME=risk-churn-platform
APP_VERSION=0.1.0
ENVIRONMENT=development  # development, staging, production
LOG_LEVEL=INFO

# ============================================================================
# API Configuration
# ============================================================================
API_HOST=0.0.0.0
API_PORT=8080
API_WORKERS=4
API_RELOAD=true  # Set to false in production

# ============================================================================
# Authentication
# ============================================================================
# Generate with: python -c "import secrets; print('sk_live_' + secrets.token_urlsafe(32))"
API_KEY=sk_test_your_api_key_here_replace_me
API_KEY_HASH_ALGORITHM=sha256

# ============================================================================
# Rate Limiting
# ============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_HOUR=1000
RATE_LIMIT_BURST=100

# ============================================================================
# Model Configuration
# ============================================================================
MODEL_V1_PATH=models/v1/model.pkl
MODEL_V2_PATH=models/v2/model.pkl
TRANSFORMER_PATH=models/transformer.pkl
ROUTING_STRATEGY=shadow  # shadow, canary, blue-green
CANARY_WEIGHT=0.1  # 10% traffic to V2

# ============================================================================
# Kafka Configuration
# ============================================================================
KAFKA_ENABLED=true
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_TOPIC_PREDICTIONS=ml.predictions
KAFKA_TOPIC_FEEDBACK=ml.feedback
KAFKA_TOPIC_DRIFT_ALERTS=ml.drift-alerts
KAFKA_TOPIC_OUTLIERS=ml.outliers
KAFKA_CONSUMER_GROUP=risk-churn-platform
KAFKA_AUTO_OFFSET_RESET=earliest

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_ENABLED=true
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=  # Leave empty for no password
REDIS_TTL=3600  # Cache TTL in seconds

# ============================================================================
# Database Configuration (PostgreSQL)
# ============================================================================
DATABASE_ENABLED=false
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=ml_platform
DATABASE_USER=ml_user
DATABASE_PASSWORD=  # Set in production via secrets manager
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20

# ============================================================================
# Monitoring & Observability
# ============================================================================
DRIFT_DETECTION_ENABLED=true
DRIFT_DETECTION_METHOD=ks  # ks, mmd, tabular
DRIFT_THRESHOLD=0.05
DRIFT_WINDOW_SIZE=1000

OUTLIER_DETECTION_ENABLED=true
OUTLIER_DETECTION_METHOD=isolation_forest
OUTLIER_THRESHOLD=0.1
OUTLIER_CONTAMINATION=0.1

PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
PROMETHEUS_PATH=/metrics

# ============================================================================
# Alerting
# ============================================================================
ALERT_LOG_ENABLED=true
ALERT_SLACK_ENABLED=false
ALERT_SLACK_WEBHOOK=  # https://hooks.slack.com/services/...
ALERT_EMAIL_ENABLED=false
ALERT_EMAIL_SMTP_HOST=smtp.gmail.com
ALERT_EMAIL_SMTP_PORT=587
ALERT_EMAIL_FROM=alerts@ml-platform.example.com
ALERT_EMAIL_TO=team@example.com
ALERT_EMAIL_PASSWORD=  # Use app-specific password

ALERT_PAGERDUTY_ENABLED=false
ALERT_PAGERDUTY_API_KEY=  # PagerDuty Integration Key

# ============================================================================
# Retraining Configuration
# ============================================================================
RETRAINING_ENABLED=true
RETRAINING_SCHEDULE=0 2 * * 0  # Cron: Sundays at 2 AM
RETRAINING_MIN_SAMPLES=10000
RETRAINING_PERFORMANCE_THRESHOLD=0.85
RETRAINING_AUTO_DEPLOY=false  # Set to true for automatic deployment

# ============================================================================
# Secrets Management
# ============================================================================
SECRETS_BACKEND=env  # env, aws, vault
AWS_REGION=us-east-1  # For AWS Secrets Manager
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

VAULT_ADDR=http://localhost:8200
VAULT_TOKEN=
VAULT_MOUNT_POINT=secret

# ============================================================================
# Feature Flags
# ============================================================================
FEATURE_EXPLAINER_ENABLED=false
FEATURE_KAFKA_MIRROR_ENABLED=true
FEATURE_SHADOW_MODE_LOGGING=true

# ============================================================================
# Development
# ============================================================================
DEBUG=false
TESTING=false
MOCK_MODELS=false  # Use mock models for testing

# ============================================================================
# Production Security
# ============================================================================
CORS_ENABLED=true
CORS_ORIGINS=https://app.example.com,https://dashboard.example.com
CORS_ALLOW_CREDENTIALS=true

HTTPS_ONLY=true  # Redirect HTTP to HTTPS
HSTS_ENABLED=true  # HTTP Strict Transport Security
HSTS_MAX_AGE=31536000  # 1 year

# ============================================================================
# Resource Limits
# ============================================================================
MAX_REQUEST_SIZE=10485760  # 10MB
MAX_CONCURRENT_REQUESTS=1000
REQUEST_TIMEOUT=30  # seconds
WORKER_TIMEOUT=120  # seconds

# ============================================================================
# Kubernetes (if deploying to K8s)
# ============================================================================
K8S_NAMESPACE=ml-platform
K8S_SERVICE_ACCOUNT=ml-platform-sa
K8S_CONFIGMAP_NAME=ml-platform-config
K8S_SECRET_NAME=ml-platform-secrets
